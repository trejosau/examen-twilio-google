<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pathfinder Robot App</title>
    <!-- Importar Tailwind CSS desde CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold text-center mb-4">Dashboard del Robot Pathfinder</h1>
    <!-- Contenedor para las vistas generadas -->
    <div id="log" class="space-y-4"></div>
</div>

<!-- Socket.io -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.js" integrity="sha512-8BHxHDLsOHx+flIrQ0DrZcea7MkHqRU5GbTHmbdzMRnAaoCIkZ97PqZcXJkKZckMMhqfoeaJE+DNUVuyoQsO3Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    // Conectar al socket en el puerto especificado
    const socket = io('http://localhost:15754/');

    // FunciÃ³n para procesar y generar vistas segÃºn el mensaje recibido
    function handleMessage(data) {
        const logContainer = document.getElementById('log');

        // Verificar si el mensaje tiene el comando "pongame"
        if (data.message.startsWith("pongame")) {
            // Se asume que el formato es "pongame X" y se extrae el valor X
            const parts = data.message.split(" ");
            const value = parts.length > 1 ? parts[1] : '';

            const view = document.createElement('div');
            view.className = 'p-4 bg-green-100 border border-green-500 rounded shadow';
            view.innerHTML = `
          <h2 class="text-xl font-bold mb-2">Comando recibido: Pongame</h2>
          <p class="text-lg">Valor: ${value}</p>
        `;
            logContainer.appendChild(view);
        } else {
            // Para otros mensajes se muestra una vista por defecto
            const view = document.createElement('div');
            view.className = 'p-4 bg-white border border-gray-300 rounded shadow';
            view.innerHTML = `
          <p class="font-bold">Topic: ${data.topic}</p>
          <p>Message: ${data.message}</p>
        `;
            logContainer.appendChild(view);
        }
    }

    // Escuchar el evento 'mqtt-message' y procesar el dato recibido
    socket.on('mqtt-message', (data) => {
        console.log('ðŸ“© Evento recibido:', data);
        handleMessage(data);
    });
</script>
</body>
</html>
